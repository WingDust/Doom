#+TITLE: Mode

*  lexical
#+begin_src emacs-lisp
;;; -*- lexical-binding: t; -*-
#+end_src

* auto save

#+begin_src emacs-lisp
(require 'auto-save)
;;(load! auto-save)
(auto-save-enable)
#+end_src

* 一个 buffer 时居中 buffer

#+begin_src emacs-lisp
(centered-window-mode t)
#+end_src


* scratch 默认使用 lisp-interaction-mode

#+begin_src emacs-lisp
(with-current-buffer "*scratch*"
  (lisp-interaction-mode)
    )
#+end_src

* 禁用 Doom 默认删除尾部空格

#+begin_src emacs-lisp
;;(package! ws-butler :disable t)
#+end_src

* 删除空格

#+begin_src emacs-lisp
(add-hook 'switch-buffer-functions
          ;;(lambda (prev curr)
          (lambda (curr)
            (cl-assert (eq curr (current-buffer)))  ;; Always t
            (delete-trailing-whitespace)))
;; (save-excursion
;;   (save-restriction
;;     (narrow-to-region 1 (buffer-size switch-buffer-functions--last-buffer))
;;   )
;; )
#+end_src
- [[https://www.gnu.org/software/emacs/manual/html_node/eintr/Buffer-Size-_0026-Locations.html][Buffer Size and the Location of Point]]
- [[https://www.gnu.org/software/emacs/manual/html_node/elisp/Narrowing.html][Narrowing]]

* 网易云音乐

#+begin_src emacs-lisp
;;(require 'netease-cloud-music)
#+end_src

* elfeed

#+begin_src emacs-lisp
(setq elfeed-feeds
      '(("https://mangatalk.net/feed" mangatalk)
        ))
#+end_src

* alda

#+begin_src emacs-lisp
(setq alda-binary-location "E:/alda/alda.exe")
#+end_src

* ivy

#+begin_src emacs-lisp
(use-package prescient
  :after counsel
  :config
  (prescient-persist-mode 1))

(use-package ivy-prescient
  :after counsel
  :config (ivy-prescient-mode 1)
  )
#+end_src

* ivy posframe
#+begin_src emacs-lisp
(use-package ivy-posframe
  :disabled
  :custom
  (ivy-posframe-width      115)
  (ivy-posframe-min-width  115)
  (ivy-posframe-height     10)
  (ivy-posframe-min-height 10)
  :config
  (setq ivy-posframe-display-functions-alist '((t . ivy-posframe-display-at-frame-center)))
  (setq ivy-posframe-parameters '((parent-frame . nil)
                                  (left-fringe . 8)
                                  (right-fringe . 8)))
  (ivy-posframe-mode 1))
#+end_src

* 取消显示行号

#+begin_src emacs-lisp
;;(setq display-line-numbers-type nil)
(remove-hook! '(prog-mode-hook text-mode-hook conf-mode-hook)
              #'display-line-numbers-mode)
#+end_src
- [[https://github.com/hlissner/doom-emacs/blob/develop/docs/faq.org][How do I change the style of line-numbers (or disable them altogether)?]]

*  lsp

#+begin_src emacs-lisp
;; doom require =pip install pytest nose black=
;; 需要 npm i -g pyright

(require 'nox)

(setq nox-python-server "pyright")
(if (eq system-type 'windows-nt)
    (setq nox-python-path "E:/python/python3.8.1/python.exe"))
(setq nox-autoshutdown t) ;; kill bufer 时自动关闭nox的服务。
(dolist (hook (list
               ;;'js-mode-hook
               ;;'rust-mode-hook
               'python-mode-hook
               ;;'ruby-mode-hook
               ;;'java-mode-hook
               ;;'sh-mode-hook
               ;;'php-mode-hook
               ;;'c-mode-common-hook
               ;;'c-mode-hook
               ;;'csharp-mode-hook
               ;;'c++-mode-hook
               ;;'haskell-mode-hook
               ))
  (add-hook hook '(lambda () (nox-ensure))))
#+end_src
  
- [[https://rgoswami.me/posts/emacs-lang-servers/][Doom Emacs and Language Servers]]
- [[https://tecosaur.github.io/emacs-config/config.html][Doom Emacs Configuration]]
